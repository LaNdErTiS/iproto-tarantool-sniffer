HEADER_MAP = {
    0x00: {
        "name": "IPROTO_REQUEST_TYPE",
        "values": {
            -1: {"name": "IPROTO_UNKNOWN"},
            0x00: {"name": "IPROTO_OK"},
            0x01: {"name": "IPROTO_SELECT"},
            0x02: {"name": "IPROTO_INSERT"},
            0x03: {"name": "IPROTO_REPLACE"},
            0x04: {"name": "IPROTO_UPDATE"},
            0x05: {"name": "IPROTO_DELETE"},
            0x07: {"name": "IPROTO_AUTH"},
            0x08: {"name": "IPROTO_EVAL"},
            0x09: {"name": "IPROTO_UPSERT"},
            0x0A: {"name": "IPROTO_CALL"},
            0x0B: {"name": "IPROTO_EXECUTE"},
            0x0C: {"name": "IPROTO_NOP"},
            0x0D: {"name": "IPROTO_PREPARE"},
            0x0E: {"name": "IPROTO_BEGIN"},
            0x0F: {"name": "IPROTO_COMMIT"},
            0x10: {"name": "IPROTO_ROLLBACK"},
            0x1E: {"name": "IPROTO_RAFT"},
            0x1F: {"name": "IPROTO_RAFT_PROMOTE"},
            0x20: {"name": "IPROTO_RAFT_DEMOTE"},
            0x28: {"name": "IPROTO_RAFT_CONFIRM"},
            0x29: {"name": "IPROTO_BALLOT/IPROTO_RAFT_ROLLBACK"},  # todo (wtf)
            0x40: {"name": "IPROTO_PING"},
            0x41: {"name": "IPROTO_JOIN"},
            0x42: {"name": "IPROTO_SUBSCRIBE"},
            0x44: {"name": "IPROTO_VOTE"},
            0x45: {"name": "IPROTO_FETCH_SNAPSHOT"},
            0x46: {"name": "IPROTO_REGISTER"},
            0x47: {"name": "IPROTO_JOIN_META"},
            0x48: {"name": "IPROTO_JOIN_SNAPSHOT"},
            0x49: {"name": "IPROTO_ID"},
            0x4A: {"name": "IPROTO_WATCH"},
            0x4B: {"name": "IPROTO_UNWATCH"},
            0x4C: {"name": "IPROTO_EVENT"},
            0x80: {"name": "IPROTO_CHUNK"},
            # as example of IPROTO_TYPE_ERROR
            0x800A: {"name": "ER_SPACE_EXISTS"},
        },
    },
    0x01: {"name": "IPROTO_SYNC"},
    0x02: {"name": "IPROTO_REPLICA_ID"},
    0x03: {"name": "IPROTO_LSN"},
    0x04: {"name": "IPROTO_TIMESTAMP"},
    0x05: {"name": "IPROTO_SCHEMA_VERSION"},
    0x06: {"name": "IPROTO_SERVER_VERSION"},
    # 0x07 in https://www.tarantool.io/en/doc/latest/reference/internals/iproto/keys/
    # only IPROTO_BALLOT_CAN_LEAD MP_BOOL, but in source it is
    # _(GROUP_ID, 0x07, MP_UINT)
    0x07: {"name": "IPROTO_GROUP_ID"},
    0x08: {"name": "IPROTO_TSN"},
    0x09: {
        "name": "IPROTO_FLAGS",
        "values": {
            0x01: {"name": "IPROTO_FLAG_COMMIT"},
            0x02: {"name": "IPROTO_FLAG_WAIT_SYNC"},
            0x04: {"name": "IPROTO_FLAG_WAIT_ACK"},
        },
    },
    0x0A: {"name": "IPROTO_STREAM_ID"},
}
